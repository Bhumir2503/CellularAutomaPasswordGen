<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Cellular Automata Password Generator</title>
		<style>
			body {
				font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
				line-height: 1.6;
				color: #333;
				max-width: 800px;
				margin: 0 auto;
				padding: 20px;
				background-color: #f5f5f5;
			}

			h1 {
				color: #2c3e50;
				text-align: center;
				margin-bottom: 30px;
			}

			.container {
				background-color: white;
				border-radius: 8px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				padding: 20px;
				margin-bottom: 20px;
			}

			.form-group {
				margin-bottom: 15px;
			}

			label {
				display: block;
				margin-bottom: 5px;
				font-weight: 600;
			}

			input[type="number"],
			input[type="range"] {
				width: 100%;
				padding: 8px;
				border: 1px solid #ddd;
				border-radius: 4px;
				box-sizing: border-box;
			}

			.slider-container {
				display: flex;
				align-items: center;
			}

			.slider-container input[type="range"] {
				flex: 1;
				margin-right: 10px;
			}

			.slider-value {
				width: 50px;
				text-align: center;
			}

			.checkbox-group {
				display: flex;
				flex-wrap: wrap;
				gap: 15px;
			}

			.checkbox-item {
				display: flex;
				align-items: center;
			}

			.checkbox-item input {
				margin-right: 5px;
			}

			.advanced-options {
				margin-top: 20px;
				border-top: 1px solid #eee;
				padding-top: 15px;
			}

			.advanced-toggle {
				background: none;
				border: none;
				color: #3498db;
				cursor: pointer;
				padding: 0;
				font-size: 14px;
				margin-bottom: 10px;
				display: flex;
				align-items: center;
			}

			.arrow {
				margin-left: 5px;
				transition: transform 0.3s;
			}

			.rotate {
				transform: rotate(180deg);
			}

			.hidden {
				display: none;
			}

			button {
				background-color: #3498db;
				color: white;
				border: none;
				padding: 10px 15px;
				border-radius: 4px;
				cursor: pointer;
				font-size: 16px;
				transition: background-color 0.3s;
				display: block;
				width: 100%;
			}

			button:hover {
				background-color: #2980b9;
			}

			#results {
				background-color: white;
				border-radius: 8px;
				box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
				padding: 20px;
				margin-top: 20px;
			}

			.password-item {
				background-color: #f9f9f9;
				padding: 10px;
				border-radius: 4px;
				margin-bottom: 10px;
				font-family: monospace;
				display: flex;
				justify-content: space-between;
				align-items: center;
			}

			.copy-btn {
				background-color: transparent;
				border: none;
				color: #3498db;
				cursor: pointer;
				padding: 5px;
				width: auto;
			}

			.copy-btn:hover {
				color: #2980b9;
				background-color: transparent;
			}

			.loading {
				text-align: center;
				margin: 20px 0;
				display: none;
			}

			.spinner {
				border: 4px solid rgba(0, 0, 0, 0.1);
				border-left-color: #3498db;
				border-radius: 50%;
				width: 30px;
				height: 30px;
				animation: spin 1s linear infinite;
				display: inline-block;
			}

			@keyframes spin {
				to {
					transform: rotate(360deg);
				}
			}

			.error {
				color: #e74c3c;
				font-size: 14px;
				margin-top: 5px;
			}

			.info-icon {
				color: #3498db;
				cursor: help;
				margin-left: 5px;
			}

			.tooltip {
				position: relative;
				display: inline-block;
			}

			.tooltip .tooltip-text {
				visibility: hidden;
				width: 200px;
				background-color: #2c3e50;
				color: white;
				text-align: center;
				border-radius: 6px;
				padding: 5px;
				position: absolute;
				z-index: 1;
				bottom: 125%;
				left: 50%;
				margin-left: -100px;
				opacity: 0;
				transition: opacity 0.3s;
				font-size: 12px;
			}

			.tooltip:hover .tooltip-text {
				visibility: visible;
				opacity: 1;
			}

			.visualization-container {
				margin-top: 30px;
				background-color: white;
				border-radius: 8px;
				padding: 15px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}

			#automaton-canvas {
				width: 100%;
				height: auto;
				border: 1px solid #ddd;
				background-color: #f9f9f9;
				border-radius: 4px;
			}

			.visualization-legend {
				display: flex;
				margin-top: 10px;
				justify-content: center;
				gap: 20px;
			}

			.legend-item {
				display: flex;
				align-items: center;
			}

			.legend-color {
				width: 20px;
				height: 20px;
				margin-right: 8px;
				border: 1px solid #ddd;
				border-radius: 3px;
			}
		</style>
	</head>
	<body>
		<h1>Cellular Automata Password Generator</h1>

		<div class="container">
			<div class="form-group">
				<label for="length">Password Length</label>
				<div class="slider-container">
					<input
						type="range"
						id="length"
						min="4"
						max="64"
						value="16"
						oninput="updateSliderValue('length')"
					/>
					<span id="length-value" class="slider-value">16</span>
				</div>
			</div>

			<div class="form-group">
				<label>Character Types</label>
				<div class="checkbox-group">
					<div class="checkbox-item">
						<input type="checkbox" id="lowercase" checked />
						<label for="lowercase">Lowercase (a-z)</label>
					</div>
					<div class="checkbox-item">
						<input type="checkbox" id="uppercase" checked />
						<label for="uppercase">Uppercase (A-Z)</label>
					</div>
					<div class="checkbox-item">
						<input type="checkbox" id="digits" checked />
						<label for="digits">Digits (0-9)</label>
					</div>
					<div class="checkbox-item">
						<input type="checkbox" id="special" checked />
						<label for="special">Special (!@#$%^&*)</label>
					</div>
				</div>
			</div>

			<div class="form-group">
				<label for="count">Number of Passwords</label>
				<div class="slider-container">
					<input
						type="range"
						id="count"
						min="1"
						max="20"
						value="3"
						oninput="updateSliderValue('count')"
					/>
					<span id="count-value" class="slider-value">3</span>
				</div>
			</div>

			<button
				type="button"
				class="advanced-toggle"
				onclick="toggleAdvanced()"
			>
				Advanced Options <span class="arrow">▼</span>
			</button>

			<div id="advanced-options" class="advanced-options hidden">
				<div class="form-group">
					<label for="rule">
						Cellular Automaton Rule
						<span class="tooltip"
							>ℹ️
							<span class="tooltip-text"
								>Rule number (0-255) for the elementary cellular
								automaton. Different rules produce different
								patterns. Rule 30 is known for its chaotic
								behavior.</span
							>
						</span>
					</label>
					<div class="slider-container">
						<input
							type="range"
							id="rule"
							min="0"
							max="255"
							value="30"
							oninput="updateSliderValue('rule')"
						/>
						<span id="rule-value" class="slider-value">30</span>
					</div>
				</div>

				<div class="form-group">
					<label for="width">
						Automaton Width
						<span class="tooltip"
							>ℹ️
							<span class="tooltip-text"
								>Number of cells in the cellular automaton.
								Higher values provide more entropy but require
								more computation.</span
							>
						</span>
					</label>
					<div class="slider-container">
						<input
							type="range"
							id="width"
							min="10"
							max="500"
							value="100"
							oninput="updateSliderValue('width')"
						/>
						<span id="width-value" class="slider-value">100</span>
					</div>
				</div>

				<div class="form-group">
					<label for="iterations">
						Iterations
						<span class="tooltip"
							>ℹ️
							<span class="tooltip-text"
								>Number of generations to evolve the automaton.
								Higher values produce more complex patterns but
								require more computation.</span
							>
						</span>
					</label>
					<div class="slider-container">
						<input
							type="range"
							id="iterations"
							min="10"
							max="500"
							value="50"
							oninput="updateSliderValue('iterations')"
						/>
						<span id="iterations-value" class="slider-value"
							>50</span
						>
					</div>
				</div>
			</div>

			<button type="button" onclick="generatePasswords()">
				Generate Passwords
			</button>
		</div>

		<div class="loading" id="loading">
			<div class="spinner"></div>
			<p>Generating passwords...</p>
		</div>

		<div id="results" style="display: none">
			<h2>Generated Passwords</h2>
			<div id="passwords-container"></div>

			<h2>Cellular Automaton Visualization</h2>
			<div class="visualization-container">
				<canvas id="automaton-canvas" width="800" height="400"></canvas>
				<div class="visualization-legend">
					<div class="legend-item">
						<div
							class="legend-color"
							style="background-color: #3498db"
						></div>
						<span>Active Cell</span>
					</div>
					<div class="legend-item">
						<div
							class="legend-color"
							style="background-color: #f5f5f5"
						></div>
						<span>Inactive Cell</span>
					</div>
				</div>
			</div>
		</div>

		<script>
			function updateSliderValue(id) {
				const slider = document.getElementById(id);
				const valueDisplay = document.getElementById(`${id}-value`);
				valueDisplay.textContent = slider.value;
			}

			function toggleAdvanced() {
				const advancedOptions =
					document.getElementById("advanced-options");
				const arrow = document.querySelector(".arrow");
				advancedOptions.classList.toggle("hidden");
				arrow.classList.toggle("rotate");
			}

			function copyToClipboard(text) {
				navigator.clipboard
					.writeText(text)
					.then(() => {
						alert("Password copied to clipboard!");
					})
					.catch((err) => {
						console.error("Could not copy text: ", err);
					});
			}

			function generatePasswords() {
				// Get values from form
				const length = parseInt(
					document.getElementById("length").value
				);
				const lowercase = document.getElementById("lowercase").checked;
				const uppercase = document.getElementById("uppercase").checked;
				const digits = document.getElementById("digits").checked;
				const special = document.getElementById("special").checked;
				const rule = parseInt(document.getElementById("rule").value);
				const width = parseInt(document.getElementById("width").value);
				const iterations = parseInt(
					document.getElementById("iterations").value
				);
				const count = parseInt(document.getElementById("count").value);

				// Validate that at least one character type is selected
				if (!lowercase && !uppercase && !digits && !special) {
					alert("Please select at least one character type.");
					return;
				}

				// Show loading indicator
				document.getElementById("loading").style.display = "block";
				document.getElementById("results").style.display = "none";

				// Prepare request data
				const requestData = {
					length: length,
					lowercase: lowercase,
					uppercase: uppercase,
					digits: digits,
					special: special,
					rule: rule,
					width: width,
					iterations: iterations,
					count: count,
				};

				// Send request to server
				fetch("/generate", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify(requestData),
				})
					.then((response) => response.json())
					.then((data) => {
						// Hide loading indicator
						document.getElementById("loading").style.display =
							"none";

						if (data.error) {
							alert(`Error: ${data.error}`);
							return;
						}

						// Display results
						const passwordsContainer = document.getElementById(
							"passwords-container"
						);
						passwordsContainer.innerHTML = "";

						data.passwords.forEach((password) => {
							const passwordItem = document.createElement("div");
							passwordItem.className = "password-item";

							const passwordText = document.createElement("span");
							passwordText.textContent = password;

							const copyButton = document.createElement("button");
							copyButton.className = "copy-btn";
							copyButton.textContent = "Copy";
							copyButton.onclick = function () {
								copyToClipboard(password);
							};

							passwordItem.appendChild(passwordText);
							passwordItem.appendChild(copyButton);
							passwordsContainer.appendChild(passwordItem);
						});

						document.getElementById("results").style.display =
							"block";
					})
					.catch((error) => {
						// Hide loading indicator
						document.getElementById("loading").style.display =
							"none";
						console.error("Error:", error);
						alert(
							"An error occurred while generating passwords. Please try again."
						);
					});
			}
		</script>
	</body>
</html>
